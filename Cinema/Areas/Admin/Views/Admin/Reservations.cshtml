@model List<Cinema.Models.Ticket>
@{
    ViewData["Title"] = "All Reservations";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<style>
    /* --- Page Background --- */
    body {
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', sans-serif;
        background: url('/images/pngtree-light-effect-particles-moving-starry-sky-background-picture-image_1439238.jpg') no-repeat center center fixed;
        background-size: cover;
        color: #fff;
    }

    /* --- Page Container / Overlay --- */
    .page-container {
        background: rgba(30, 30, 30, 0.9);
        padding: 30px;
        border-radius: 12px;
        margin: 20px auto;
        max-width: 1200px;
        box-shadow: 0 0 20px rgba(214, 169, 77, 0.3);
    }

    /* --- Page Heading --- */
    h2 {
        font-size: 2rem;
        background: linear-gradient(90deg, #d6a94d, #e8b958, #f5d38c);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 0 6px #d6a94d, 0 0 12px #e8b958;
        margin-bottom: 20px;
        text-align: center;
    }

    /* --- Search Form --- */
    .search-form {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }

        .search-form input[type="text"] {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #d6a94d;
            background-color: rgba(47, 47, 47, 0.7);
            color: #fff;
        }

            .search-form input[type="text"]::placeholder {
                color: #e3ae42;
            }

        .search-form button {
            padding: 10px 20px;
            border-radius: 8px;
            border: 1px solid #e3ae42;
            background-color: #d6a94d;
            color: #000;
            cursor: pointer;
            transition: 0.3s;
        }

            .search-form button:hover {
                background-color: #e8b958;
            }

    /* --- Table Styling --- */
    .cinema-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 8px;
    }

        .cinema-table th, .cinema-table td {
            padding: 12px 15px;
            border-radius: 8px;
        }

        .cinema-table th {
            background-color: rgba(214, 169, 77, 0.2);
            color: #fff;
            text-align: left;
        }

    /* --- Sortable headers --- */
    .sortable-header {
        color: #fff !important;
        text-decoration: none;
        font-weight: bold;
        display: inline-block;
        transition: 0.3s;
    }

        .sortable-header:hover,
        .sortable-header:visited,
        .sortable-header:active {
            color: #fff !important; /* винаги бяло */
            text-decoration: none;
            text-shadow: 0 0 4px #d6a94d, 0 0 8px #e8b958;
        }

    /* --- Table cells --- */
    .cinema-table td {
        background-color: rgba(47, 47, 47, 0.85);
    }

    /* --- Hover Effect for Rows --- */
    .cinema-table tbody tr:hover td {
        transform: translateY(-3px);
        box-shadow: 0 4px 12px rgba(255, 215, 0, 0.5);
        transition: all 0.2s;
    }

    /* --- Delete Button --- */
    .btn-delete {
        padding: 5px 10px;
        border-radius: 8px;
        border: 1px solid #e3ae42;
        background-color: transparent;
        color: #e3ae42;
        cursor: pointer;
        transition: 0.3s;
    }

        .btn-delete:hover {
            background-color: #d6a94d;
            color: #000;
        }

    /* --- Fade-in Animation --- */
    .fade-in {
        opacity: 0;
        transform: translateY(20px);
        animation: fadeIn 1s forwards;
    }

    @@keyframes fadeIn {
        to

    {
        opacity: 1;
        transform: translateY(0);
    }

    }
</style>

<div class="page-container fade-in">
    <h2>All Reservations</h2>

    <form method="get" class="search-form">
        <input type="text" name="searchTerm" placeholder="Search by movie or user" value="@ViewBag.SearchTerm" />
        <button type="submit">Search</button>
    </form>

    <div class="table-responsive">
        <table class="cinema-table">
            <thead>
                <tr>
                    <th>
                        <a class="sortable-header" asp-action="Reservations" asp-route-sortOrder="@ViewBag.UserSortParam" asp-route-searchTerm="@ViewBag.SearchTerm">
                            User
                            @if (ViewBag.CurrentSort == "user_asc")
                            {
                                <span>▲</span>
                            }
                            else if (ViewBag.CurrentSort == "user_desc")
                            {

                                <span>▼</span>
                            }
                        </a>
                    </th>
                    <th>
                        <a class="sortable-header" asp-action="Reservations" asp-route-sortOrder="@ViewBag.MovieSortParam" asp-route-searchTerm="@ViewBag.SearchTerm">
                            Movie
                            @if (ViewBag.CurrentSort == "movie_asc")
                            {
                                <span>▲</span>
                            }
                            else if (ViewBag.CurrentSort == "movie_desc")
                            {

                                <span>▼</span>
                            }
                        </a>
                    </th>
                    <th>
                        <a class="sortable-header" asp-action="Reservations" asp-route-sortOrder="@ViewBag.DateSortParam" asp-route-searchTerm="@ViewBag.SearchTerm">
                            Date
                            @if (ViewBag.CurrentSort == "date_asc")
                            {
                                <span>▲</span>
                            }
                            else if (ViewBag.CurrentSort == "date_desc")
                            {

                                <span>▼</span>
                            }
                        </a>
                    </th>
                    <th>
                        <a class="sortable-header" asp-action="Reservations" asp-route-sortOrder="@ViewBag.HallSortParam" asp-route-searchTerm="@ViewBag.SearchTerm">
                            Hall
                            @if (ViewBag.CurrentSort == "hall_asc")
                            {
                                <span>▲</span>
                            }
                            else if (ViewBag.CurrentSort == "hall_desc")
                            {

                                <span>▼</span>
                            }
                        </a>
                    </th>
                    <th>
                        <a class="sortable-header" asp-action="Reservations" asp-route-sortOrder="@ViewBag.SeatSortParam" asp-route-searchTerm="@ViewBag.SearchTerm">
                            Seat
                            @if (ViewBag.CurrentSort == "seat_asc")
                            {
                                <span>▲</span>
                            }
                            else if (ViewBag.CurrentSort == "seat_desc")
                            {

                                <span>▼</span>
                            }
                        </a>
                    </th>
                    <th>
                        <a class="sortable-header" asp-action="Reservations" asp-route-sortOrder="@ViewBag.PurchasedSortParam" asp-route-searchTerm="@ViewBag.SearchTerm">
                            Purchased
                            @if (ViewBag.CurrentSort == "purchased_asc")
                            {
                                <span>▲</span>
                            }
                            else if (ViewBag.CurrentSort == "purchased_desc")
                            {

                                <span>▼</span>
                            }
                        </a>
                    </th>
                    <th>
                        <a class="sortable-header" asp-action="Reservations" asp-route-sortOrder="@ViewBag.TicketSortParam" asp-route-searchTerm="@ViewBag.SearchTerm">
                            Ticket Type / Price
                            @if (ViewBag.CurrentSort == "ticket_asc")
                            {
                                <span>▲</span>
                            }
                            else if (ViewBag.CurrentSort == "ticket_desc")
                            {

                                <span>▼</span>
                            }
                        </a>
                    </th>
                    <th>
                        <a class="sortable-header" asp-action="Reservations" asp-route-sortOrder="@ViewBag.IsPaidSortParam" asp-route-searchTerm="@ViewBag.SearchTerm">
                            Paid
                            @if (ViewBag.CurrentSort == "paid_asc")
                            {
                                <span>▲</span>
                            }
                            else if (ViewBag.CurrentSort == "paid_desc")
                            {

                                <span>▼</span>
                            }
                        </a>
                    </th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var ticket in Model)
                {
                    <tr>
                        <td>@ticket.CustomerName</td>
                        <td>@ticket.Projection.Movie.Title</td>
                        <td>@ticket.Projection.ProjectionTime.ToString("dd.MM.yyyy HH:mm")</td>
                        <td>@ticket.Projection.Hall.Name</td>
                        <td>Row: @ticket.SeatRow, Seat: @ticket.SeatColumn</td>
                        <td>@ticket.PurchaseTime.ToLocalTime().ToString("dd.MM.yyyy HH:mm")</td>
                        <td>@ticket.TicketType / @ticket.Price.ToString("C")</td>
                        <td>@(ticket.IsPaid ? "Yes" : "No")</td>
                        <td>
                            <form method="post" asp-action="DeleteReservation" asp-route-id="@ticket.Id" onsubmit="return confirm('Are you sure you want to delete this reservation?');">
                                <button type="submit" class="btn-delete">Delete</button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
