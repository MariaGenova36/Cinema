@{
    ViewData["Title"] = "Checkout";

    var projection = ViewBag.Projection as Cinema.Models.Projection;
    var rows = ViewBag.SeatRows as List<int>;
    var cols = ViewBag.SeatCols as List<int>;
    var type = ViewBag.TicketType as string;
    var multiplier = decimal.Parse(
        ViewBag.TicketMultiplier as string,
        System.Globalization.CultureInfo.InvariantCulture
    );

    var pricePerTicket = projection.TicketPrice * multiplier;
    var total = rows.Count * pricePerTicket;
}

<link rel="stylesheet" href="~/css/checkout.css" />
<link rel="stylesheet" href="~/css/createreservation.css" />

<h2 class="mb-4">Checkout</h2>

<div class="card shadow p-4 mb-4 bg-dark text-white rounded-3" style="animation: fadeInUp 0.8s ease-out;">
    <h4 class="mb-3">Movie Details</h4>
    <p><strong>Movie:</strong> @projection.Movie.Title</p>
    <p><strong>Time:</strong> @projection.ProjectionTime.ToString("dd.MM.yyyy HH:mm")</p>
    <p><strong>Hall:</strong> @projection.Hall.Name</p>
</div>

<div class="card shadow p-4 mb-4 bg-dark text-white rounded-3" style="animation: fadeInUp 0.8s ease-out; animation-delay: 0.2s;">
    <h4 class="mb-3">Your Selection</h4>
    <p><strong>Ticket type:</strong> @type</p>
    <p><strong>Seats:</strong></p>
    <div class="seat-grid-wrapper mb-3 p-3" style="gap:6px;">
        @for (int i = 0; i < rows.Count; i++)
        {
            <span class="seat-btn seat-selected" style="pointer-events:none; margin:2px;">@rows[i]-@cols[i]</span>
        }
    </div>
    <p><strong>Price per ticket:</strong> @pricePerTicket.ToString("F2") lv.</p>
    <h5>Total: @total.ToString("F2") lv.</h5>
</div>

<div class="mb-4" style="animation: fadeInUp 0.8s ease-out; animation-delay:0.4s;">
    <form asp-action="ConfirmCheckout" method="post" class="d-flex gap-2">
        <button type="submit" class="btn btn-confirm btn-lg">
            Confirm & Pay
        </button>
        <a asp-action="Create" asp-route-projectionId="@projection.Id" class="btn btn-secondary btn-lg">
            Cancel
        </a>
    </form>
</div>